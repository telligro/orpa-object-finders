let fo$,finderObj=null;class DOMNodePathStep{constructor(e,t){this.value=e,this.optimized=t||!1}toString(){return this.value}}class Finder{constructor(e,t){return finderObj||(finderObj=this),this.doc={url:e.location.href,identity:t||{}},this.styles={backgroundColor:"",highightColor:"rgb(255,223,170)"},this.fo$=jQuery.noConflict(),fo$=this.fo$,finderObj=this}start(e){window.finderStopped=!1,fo$(document).on("click.finder",e=>{if(console.log("R-Clicked With Control %s",e.ctrlKey),e.ctrlKey)return e.preventDefault(),!1}),fo$(document).on("mouseover.finder",e=>{finderObj.highlight(e.target)}),fo$(document).on("mouseout.finder",e=>{finderObj.highlight(e.target,!0)}),fo$(document).on("mousedown.finder",t=>{if(!t.ctrlKey)return;const r={target:{}};return r.target.xpath=finderObj.xPath(t.target,!0),r.target.xpathFull=finderObj.xPath(t.target,!1),r.target.framePath=finderObj.getFramePath(t.target),r.target.attributes=finderObj.getTargetAttributes(t.target),r.url=window.location.href,t.preventDefault(),e.call(e,r),!1})}stop(){console.log("Stop EVent Called"),fo$(document).off(".finder"),window.finderStopped=!0}highlight(e,t){t?fo$(e).css("background-color",finderObj.styles.backgroundColor):(finderObj.styles.backgroundColor=e.style.backgroundColor,fo$(e).css("background-color",finderObj.styles.highightColor))}getTargetAttributes(e){let t={};return fo$.each(fo$(e)[0].attributes,function(e,r){t[r.name]=r.value}),t.child=finderObj.getTargetPreviewAttributes(fo$(e).children().eq(0)),t.next=finderObj.getTargetPreviewAttributes(fo$(e).next()),t.prev=finderObj.getTargetPreviewAttributes(fo$(e).prev()),t.parent=finderObj.getTargetPreviewAttributes(fo$(e).parent()),t}getTargetPreviewAttributes(e){const t=["tagName","id","name","class"];let r={};return fo$(e).length>0&&(r=finderObj.getProps(e,t)),r}getProps(e,t){let r={};return fo$.each(t,(t,o)=>{const n=fo$(e).prop(o);void 0!==n&&(r[o]=n)}),r}getFramePath(e){let t,r=e instanceof Window?e:e.ownerDocument.defaultView;if(!r.frameElement)return"";let o=finderObj.getFramePath(r.frameElement);return t=""===o?o:o+"->",t+=finderObj.xPath(r.frameElement,!0)}xPath(e,t){if(e.nodeType===Node.DOCUMENT_NODE)return"/";let r=[],o=e;for(;o;){let e=this._xPathValue(o,t);if(!e)break;if(r.push(e),e.optimized)break;o=o.parentNode}return r.reverse(),(r.length&&r[0].optimized?"":"/")+r.join("/")}_xPathValue(e,t){let r,o=this._xPathIndex(e);if(-1===o)return null;switch(e.nodeType){case Node.ELEMENT_NODE:if(t&&e.getAttribute("id"))return new DOMNodePathStep('//*[@id="'+e.getAttribute("id")+'"]',!0);r=e.localName;break;case Node.ATTRIBUTE_NODE:r="@"+e.nodeName;break;case Node.TEXT_NODE:case Node.CDATA_SECTION_NODE:r="text()";break;case Node.PROCESSING_INSTRUCTION_NODE:r="processing-instruction()";break;case Node.COMMENT_NODE:r="comment()";break;case Node.DOCUMENT_NODE:default:r=""}return o>0&&(r+="["+o+"]"),new DOMNodePathStep(r,e.nodeType===Node.DOCUMENT_NODE)}_xPathIndex(e){function t(e,t){if(e===t)return!0;if(e.nodeType===Node.ELEMENT_NODE&&t.nodeType===Node.ELEMENT_NODE)return e.localName===t.localName;if(e.nodeType===t.nodeType)return!0;return(e.nodeType===Node.CDATA_SECTION_NODE?Node.TEXT_NODE:e.nodeType)===(t.nodeType===Node.CDATA_SECTION_NODE?Node.TEXT_NODE:t.nodeType)}let r,o=e.parentNode?e.parentNode.children:null;if(!o)return 0;for(let n=0;n<o.length;++n)if(t(e,o[n])&&o[n]!==e){r=!0;break}if(!r)return 0;let n=1;for(let r=0;r<o.length;++r)if(t(e,o[r])){if(o[r]===e)return n;++n}return-1}}
